readDataFrom: aDataStream size: varsOnDisk
	"Make self be an object based on the contents of aDataStream, which was
	   generated by the object¼s storeDataOn: method. Return self.
	 Read in the instance-variables written by Object>>storeDataOn:.
	 NOTE: This method must match its corresponding storeDataOn:
	   method. Also, it must send beginReference: after instantiating
	   the new object but before reading any objects from aDataStream
	   that might reference it.
	: allow fewer inst vars, instance does reading, see SmartRefStream."
	| cntInstVars cntIndexedVars |

	cntInstVars _ self class instSize.
	self class isVariable
		ifTrue: [cntIndexedVars _ varsOnDisk - cntInstVars.
				cntIndexedVars < 0 ifTrue: [
					self error: 'Class has changed too much.  Define a convertxxx method']]
		ifFalse: [cntIndexedVars _ 0.
				cntInstVars _ varsOnDisk]. 	"OK if fewer than now"

	aDataStream beginReference: self.
	1 to: cntInstVars do:
		[:i | self instVarAt: i put: aDataStream next].
	1 to: cntIndexedVars do:
		[:i | self basicAt: i put: aDataStream next].
	"Total number read MUST be equal to varsOnDisk!"
	^ self